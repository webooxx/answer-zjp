
#### 郑巨鹏  13:23:32


昨晚我运行这个mysql-_user1.php的时候在22行出错误，而且我var_dump($res)浏览器返回一个布尔值给我，今天早上再运行就变成下载了，这是怎么回事？？

[!t1](img/mysqli_result.t1.png?raw=true)

[!t2](img/mysqli_result.t2.png?raw=true)

#### 徐振华  13:36:36


1. 报错，请给出错误信息。并先对错误信息进行百度。

2. 打开一个.php 文件，变成下载。

直接原因：WEB 服务器不支持 Php（如不理解，仔细参考下面的根本原因）
解决方案：a.) 确认PHP程序安装正确， b.) 确认 WEB服务器配置正确，Php文件交给了 Php解释器翻译。

根本原因：

a.) 浏览器能接受3大类型的文件。 按content-type 区分。 


        content-type:text/html ，网页文件
        content-type:text/javascript 、脚本；content-type:text/css、样式 content-type:image/jpg 图片……等网页资源文件

        content-type:text/txt、content-type:rar……一系列的二进制文件。

当浏览器遇到了二进制文件，不是解析呈现，而是返回的时候，就会把「请求结果」 另存为一个文件

b.) WEB服务器接收到一个「HTTP请求」的时候。

        如果是静态HTML文件（http://127.0.0.1/index.html），会把文件内容直接返回给浏览器。类型是 text/html

        如果是其他类型的文件（非资源文件），会根据配置进行决定。默认情况，会返回这个文件的内容。但是 有可能是 content-type: raw 之类的。

        如果服务器的配置中决定对 .php 后缀进行特别的解析（（http://127.0.0.1/index.php），用特定的程序翻译，并且返回内容，同时指定返回的内容是 text/html 的话，那你能看到 .php 和 .html  都是一样的效果，都是一个网页。

c.) 如果你打开一个 .php 的URL，但是，浏览器的动作却是下载文件的话，那么：

        i. 这个服务器的配置中，没有关于.php 的解析操作。
        ii. 这个服务器的配置中，对 .php 解析的操作流程有问题。（交给了错误的解析程序，解析程序返回不正确，配置中返回的content-type不正确）

#### 郑巨鹏  13:40:05


嗯，header调好了


#### 郑巨鹏  13:40:21


执行后返回这个

[!t3](img/mysqli_result.t3.png?raw=true)

#### 徐振华  13:40:41

光看你的代码，猜测你的错误有可能是：
if( $mysqli ->connect_error){
    die( "连接失败".$mysqli_connect_error );
}

试试下面这个：
die( "连接失败".$mysqli ->connect_error );


#### 郑巨鹏  13:41:16


好像没什么不同啊


#### 徐振华  13:41:19


不是


#### 郑巨鹏  13:41:28


..


#### 徐振华  13:41:29


你的错误信息和我猜测的不一样。

#### 郑巨鹏  13:41:51


是22行while($row=$res->mysqli_fetch_row()){


#### 徐振华  13:42:06


你的错误信息说的很清楚了。

mysqli 返回的资源 不支持 mysqli_fetch_row 这个方法


#### 郑巨鹏  13:42:40


配置php.ini错误了？


#### 徐振华  13:43:04


改成这样试试

while($row = mysqli_fetch_row( $res ) ){


#### 郑巨鹏  13:43:56


成功了

#### 郑巨鹏  13:44:40


但是我想用while($row=$res->mysqli_fetch_row()){的话需要在php.ini里修改什么吗？

#### 徐振华  13:44:54


这句话是什么意思。

#### 徐振华  13:45:31


用你的语言描述出来。

#### 郑巨鹏  13:45:35


while($row = mysqli_fetch_row( $res ) ){   是面向过程d编程方式，我想用面向对象的编程方式/while($row=$res->mysqli_fetch_row()){

#### 徐振华  13:45:56


不，就解释这句代码是想要做什么。

#### 徐振华  13:46:01


用直白的语言说。

#### 郑巨鹏  13:46:55


循环($row=$res引用mysqli_fetch_row())

#### 徐振华  13:47:08


对。


#### 郑巨鹏  13:47:17

= =


#### 徐振华  13:47:39


循环执行（ 当 bool 判断 $row  为 true 的时候    （ $row 赋值为 $res->mysqli_fetch_row() ） ）


#### 徐振华  13:47:48


赋值为 $res->mysqli_fetch_row() 


#### 徐振华  13:47:55


$res 是什么？


#### 郑巨鹏  13:48:39


$res=$mysqli->query($sql)


#### 郑巨鹏  13:49:02


sql返回的结果集


#### 徐振华  13:49:20


$res 是  ( new mysqli ( ... ) )  一个 mysqli 对象，-> query( $sql ) 执行了一个  $sql  之后的返回值


#### 徐振华  13:49:23


对


#### 徐振华  13:49:49


这个结果集，是对象吗？有  mysqli_fetch_row 方法吗？


#### 徐振华  13:50:04


这个 结果集 的结构是怎么样的？


#### 徐振华  13:51:10



http://php.net/manual/zh/mysqli.query.php

失败时返回 FALSE，通过mysqli_query() 成功执行SELECT, SHOW, DESCRIBE或 EXPLAIN查询会返回一个mysqli_result 对象，其他查询则返回TRUE。


#### 徐振华  13:51:19


http://php.net/manual/zh/class.mysqli-result.php


#### 徐振华  13:52:17

[!t4](img/mysqli_result.t4.png?raw=true)

#### 徐振华  13:52:53


所有东西，尽在帮助手册。


#### 郑巨鹏  13:53:02


好吧..


#### 郑巨鹏  13:53:27

#### 徐振华  13:54:01


$res -> fetch_row( )


#### 徐振华  13:54:24


http://php.net/manual/zh/mysqli-result.fetch-row.php


#### 郑巨鹏  13:56:25


 不对，我在手册搜索fetch_row没有！！！然后我又搜索mysqli_fetch_row

[!t5](img/mysqli_result.t5.png?raw=true)

#### 徐振华  13:57:22


能在线查就在线查，毕竟人家也一把年纪了，好几年前的文档了。


#### 郑巨鹏  13:57:30


= =我用错函数了？？


#### 郑巨鹏  13:57:


用的方式不对


#### 徐振华  13:58:16


mysqli_result::fetch_row


#### 徐振华  13:58:25


这就是 fetch_row 啊


#### 徐振华  13:58:37


:: 这个意思是调用静态方法


#### 郑巨鹏  13:58:57

[!t6](img/mysqli_result.t6.png?raw=true)

#### 郑巨鹏  13:59:15


那为什么用->而不是::


#### 郑巨鹏  13:59:59


我昨晚还没找到它的作用是什么


#### 徐振华  14:00:00


类的成员：

变量
方法/函数

有几种类型

静态
私有
保护
公有


#### 徐振华  14:00:42


你执行 ->query( $sql ) 总要返回点什么东西吧？


#### 郑巨鹏  14:00:56


是啊


#### 徐振华  14:01:04


返回的就是 「mysqli_resut」 的「实例」


#### 郑巨鹏  14:01:20


嗯

#### 徐振华  14:01:25


你想要 $res->mysqli_fetch_row ，那也要 $res 支持这个方法吧？


#### 徐振华  14:01:37


那你怎么知道 $res 支持还是不支持？


#### 郑巨鹏  14:02:02


我不知道


#### 徐振华  14:02:46


逻辑顺序是这样的：

$res  = 「执行 ->query( $sql ) 」 ->  返回 「mysqli_resut」 的「实例」


#### 徐振华  14:02:55


所以 $res 就是一个 「mysqli_resut」 的「实例」


#### 徐振华  14:03:20


所以 $res 有什么方法，看  「mysqli_resut」  对象就好了，它是模板。


#### 郑巨鹏  14:04:15


我还是晕呼呼的


#### 郑巨鹏  14:05:24


mysqli_result::fetch_row和mysqli_fetch_row的功能是一样的啊


#### 徐振华  14:06:04


你理解下面的代码吗：

        class  preson {
           function sayHello(){
             echo 'hello';
           }
        }

        class  dog {
           function sayWangWang(){
             echo 'wang wang!';
           }
        }



        $zjp = new preson();

        $xiaobao = new dog();


#### 郑巨鹏  14:06:56

输出hello和wang wang


#### 徐振华  14:07:00


没有。


#### 徐振华  14:07:03


什么都没有输出。


#### 郑巨鹏  14:07:21


呃，那是ni没有调用


#### 徐振华  14:07:25


我还没有做操作呢，只是「实例化」了2个对象。看下面


#### 徐振华  14:07:44


$zjp -> sayWangWang(); 会有什么后果？


#### 郑巨鹏  14:08:19


调用那个方法，然后输出wang wang


#### 徐振华  14:08:25

仔细看


#### 郑巨鹏  14:09:42


应该是$xiaobao -> sayWangWang();


#### 徐振华  14:09:52


不，我就问  $zjp -> sayWangWang(); 会有什么后果？


#### 郑巨鹏  14:10:02


错误


#### 徐振华  14:10:05


对


#### 郑巨鹏  14:10:10


= =


#### 徐振华  14:10:15


尝试想想，错误信息是什么


#### 郑巨鹏  14:10:36


没有这个对象。。


#### 徐振华  14:11:24

[!t3](img/mysqli_result.t3.png?raw=true)

#### 徐振华  14:11:33


这是你发的错误信息、


#### 郑巨鹏  14:11:45


嗯啊


#### 徐振华  14:12:39


会报这样的错误。

        Fatal error （致命错误）
        Call to undefined method （调用了没有定义的方法）
        preson :: sayWangWang( ) （ 原始的类，以及尝试调用的方法）


#### 郑巨鹏  14:13:29


你是说$res不能调用mysqli_fetch_row?


#### 郑巨鹏  14:13:43


它不支持？


#### 徐振华  14:13:46


YES


#### 徐振华  14:14:06



现在问另外一个问题。


        $zjp = new SuperMan();
        $zjp -> fly();


会有什么后果？



#### 郑巨鹏  14:14:58


没有这个函数咯，返回错误信息


#### 徐振华  14:15:20


你怎么知道没有这个函数？


#### 徐振华  14:15:31


 new SuperMan();


#### 徐振华  14:15:43


类名是 SuperMan 噢。


#### 郑巨鹏  14:15:52


= == =  == =  == = = = == = =


#### 郑巨鹏  14:16:19


我不知道会有什么后果


#### 徐振华  14:16:23


没错。


#### 徐振华  14:16:28


那你知道，你缺少什么信息吗？


#### 郑巨鹏  14:17:38


别问我了，你一口气说完吧，别绕圈子了，快晕啦


#### 徐振华  14:18:16


如果想知道：


        $zjp = new SuperMan();
        $zjp -> fly();

的调用结果，还缺少什么信息？

---

你缺少 SuperMan 类的结构。

#### 郑巨鹏  14:18:48


你肯定是被绕晕很多次，这才来绕晕我。。。。我知道啊，我不知道怎么描述


#### 徐振华  14:19:24


没有，我不想绕圈子。语言，是思维的表述。说不出来，想不清楚。


#### 郑巨鹏  14:20:01

#### 徐振华  14:20:13


程序都是很直白的东西，有时候你太聪明了。


#### 郑巨鹏  14:21:41


我们还是说mysqli_fetch_row吧，结果集不能调用mysqli_fetch_row是系统不支持这样的方式吗？


#### 徐振华  14:21:48


是


#### 郑巨鹏  14:22:13


早说啊
